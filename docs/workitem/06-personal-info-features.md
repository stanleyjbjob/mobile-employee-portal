# 工作項目 06 - 個人資訊查詢功能開發

## 📋 基本資訊
- **工作項目編號**: WI-006
- **優先級**: 高
- **預估工作量**: 5-6 天
- **負責人員**: 前後端工程師
- **前置條件**: WI-004 (基礎 API 完成), WI-005 (前端框架完成)
- **階段**: 第一階段 (Week 7-8)

## 🎯 工作目標
開發完整的個人資訊查詢功能，包括個人基本資料維護、薪資單查詢下載、扣繳憑單查詢下載等核心功能。

## 📝 詳細工作內容

### 後端功能強化
- [ ] 完善 EmployeesController API 端點
- [ ] 實作個人資料更新驗證邏輯
- [ ] 建立檔案上傳處理機制 (個人照片)
- [ ] 實作薪資單 PDF 產生功能
- [ ] 建立扣繳憑單 PDF 產生功能
- [ ] 實作檔案下載權限控制
- [ ] 建立資料變更審核機制
- [ ] 實作個人資料修改日誌記錄

### 個人基本資料功能
- [ ] **ProfileComponent** - 個人檔案頁面
- [ ] **EditProfileComponent** - 編輯個人資料
- [ ] **ChangePasswordComponent** - 變更密碼
- [ ] **ProfilePhotoComponent** - 個人照片上傳
- [ ] 實作表單驗證 (前端)
- [ ] 建立個人資料 Service
- [ ] 實作資料同步機制

### 薪資資訊功能
- [ ] **SalaryListComponent** - 薪資單列表
- [ ] **SalaryDetailComponent** - 薪資單詳細內容
- [ ] **PayslipDownloadComponent** - 薪資單下載
- [ ] 實作薪資資料搜尋和篩選
- [ ] 建立薪資資料 Service
- [ ] 實作 PDF 檢視器整合
- [ ] 建立下載進度指示器

### 扣繳憑單功能
- [ ] **TaxStatementListComponent** - 扣繳憑單列表
- [ ] **TaxStatementDetailComponent** - 扣繳憑單詳細內容
- [ ] 實作年度別篩選功能
- [ ] 建立扣繳憑單 Service
- [ ] 實作批量下載功能
- [ ] 建立列印友善的檢視模式

### 前端服務層
- [ ] **EmployeeService** - 員工資料服務
- [ ] **SalaryService** - 薪資資料服務
- [ ] **FileService** - 檔案處理服務
- [ ] **DownloadService** - 檔案下載服務
- [ ] 實作 HTTP 快取機制
- [ ] 建立離線資料儲存
- [ ] 實作資料同步狀態管理

### 使用者體驗優化
- [ ] 實作資料載入骨架屏
- [ ] 建立檔案下載進度條
- [ ] 實作圖片延遲載入
- [ ] 建立觸控友善的操作介面
- [ ] 實作下拉更新功能
- [ ] 建立無資料狀態頁面
- [ ] 實作錯誤重試機制

## ✅ 完成標準
- [ ] 使用者可以查看和編輯個人基本資料
- [ ] 個人照片上傳功能正常運作
- [ ] 密碼變更功能安全可靠
- [ ] 薪資單查詢和下載功能完整
- [ ] 扣繳憑單查詢和下載功能完整
- [ ] 所有表單驗證正確且使用者友善
- [ ] 檔案下載功能穩定可靠
- [ ] 行動裝置使用體驗良好
- [ ] 所有功能通過測試

## 📋 頁面結構
### 個人資訊主頁
- **個人檔案卡片**: 照片、姓名、職稱、部門
- **快速操作**: 編輯資料、變更密碼、上傳照片
- **統計資訊**: 本月薪資、今年扣繳金額等

### 個人資料編輯
- **基本資料**: 姓名、生日、聯絡方式
- **聯絡資訊**: 地址、電話、緊急聯絡人
- **銀行資訊**: 薪資轉帳帳戶 (僅顯示後四碼)
- **其他資訊**: 興趣、專長等

### 薪資資訊頁面
- **薪資單列表**: 月份、基本薪資、實領金額
- **搜尋篩選**: 年份、月份篩選
- **統計圖表**: 年度薪資趨勢圖
- **下載功能**: 單筆或批量下載

## 🔒 安全性考量
- [ ] 個人資料存取權限控制
- [ ] 敏感資料顯示遮罩處理
- [ ] 檔案下載防盜連結
- [ ] 個人照片檔案類型和大小限制
- [ ] 資料傳輸加密
- [ ] 操作日誌記錄
- [ ] 防止未授權資料存取

## 📊 API 端點清單
### 個人資料相關
1. `GET /api/employees/me` - 取得個人基本資料
2. `PUT /api/employees/me` - 更新個人基本資料
3. `POST /api/employees/me/photo` - 上傳個人照片
4. `PUT /api/employees/me/password` - 變更密碼

### 薪資資料相關
5. `GET /api/salaries/my-payslips` - 取得薪資單列表
6. `GET /api/salaries/payslip/{id}` - 下載薪資單 PDF
7. `GET /api/salaries/payslips/search` - 搜尋薪資單

### 扣繳憑單相關
8. `GET /api/salaries/tax-statements` - 取得扣繳憑單列表
9. `GET /api/salaries/tax-statement/{id}` - 下載扣繳憑單 PDF
10. `GET /api/salaries/tax-statements/{year}` - 取得特定年度扣繳憑單

## 🧪 測試項目
- [ ] 個人資料 CRUD 功能測試
- [ ] 檔案上傳功能測試
- [ ] PDF 產生和下載測試
- [ ] 表單驗證測試
- [ ] 權限控制測試
- [ ] 行動裝置相容性測試
- [ ] 效能測試 (大檔案下載)
- [ ] 安全性測試

## 📱 行動裝置優化
- [ ] 觸控友善的表單控制項
- [ ] 適當的鍵盤類型設定
- [ ] 檔案選擇器優化
- [ ] 下載進度可視化
- [ ] 網路狀態感知
- [ ] 離線資料快取
- [ ] 手勢操作支援

## 🔗 相關資源
- Angular Reactive Forms 文件
- File Upload 最佳實務
- PDF.js 整合指南
- Progressive Web App 指南

## 📋 後續工作項目
- WI-007: 公告系統開發
- WI-008: 活動報名系統開發

## 📝 備註
- 確保所有個人敏感資料都有適當的保護
- 建立完整的錯誤處理和使用者回饋機制
- 考慮未來整合 HR 系統的資料同步需求
- 實作適當的資料快取策略以提升效能
