# 工作項目 09 - 問卷調查系統開發

## 📋 基本資訊
- **工作項目編號**: WI-009
- **優先級**: 中高
- **預估工作量**: 6-7 天
- **負責人員**: 前後端工程師
- **前置條件**: WI-004 (基礎 API 完成), WI-005 (前端框架完成)
- **階段**: 第二階段 (Month 5)

## 🎯 工作目標
建立靈活且功能完整的問卷調查系統，支援多種題型、邏輯跳轉、統計分析等功能，提升企業內部意見收集效率。

## 📝 詳細工作內容

### 後端功能開發
- [ ] 完善 SurveysController API 端點
- [ ] 建立問卷設計器資料結構
- [ ] 實作多種題型支援 (單選、多選、填空、量表等)
- [ ] 建立問卷邏輯跳轉引擎
- [ ] 實作問卷回應驗證機制
- [ ] 建立問卷統計分析服務
- [ ] 實作問卷匿名和實名模式
- [ ] 建立問卷模板和複製功能

### 問卷設計器 (管理員)
- [ ] **SurveyDesignerComponent** - 問卷設計主頁面
- [ ] **QuestionEditorComponent** - 題目編輯器
- [ ] **QuestionTypePickerComponent** - 題型選擇器
- [ ] **LogicBuilderComponent** - 邏輯跳轉設計器
- [ ] **SurveyPreviewComponent** - 問卷預覽功能
- [ ] **SurveySettingsComponent** - 問卷設定 (時間、權限等)
- [ ] **TemplateManagerComponent** - 問卷範本管理
- [ ] **SurveyPublishComponent** - 問卷發布設定

### 問卷填答介面 (使用者)
- [ ] **SurveyListComponent** - 可填問卷列表
- [ ] **SurveyFormComponent** - 問卷填答表單
- [ ] **ProgressTrackerComponent** - 填答進度指示器
- [ ] **SurveyThankYouComponent** - 完成感謝頁面
- [ ] **MySurveyResponsesComponent** - 我的問卷回應記錄
- [ ] 實作自動儲存草稿功能
- [ ] 建立跨頁面填答支援
- [ ] 實作填答驗證和提示

### 統計分析功能
- [ ] **SurveyAnalyticsComponent** - 問卷分析儀表板
- [ ] **ResponseStatisticsComponent** - 回應統計圖表
- [ ] **CrossAnalysisComponent** - 交叉分析功能
- [ ] **ExportReportComponent** - 報表匯出功能
- [ ] **RealTimeStatsComponent** - 即時統計顯示
- [ ] 實作多種圖表類型 (長條圖、圓餅圖、折線圖)
- [ ] 建立統計資料快取機制
- [ ] 實作進階篩選和分群分析

### 前端服務層
- [ ] **SurveyService** - 問卷資料服務
- [ ] **ResponseService** - 回應管理服務
- [ ] **AnalyticsService** - 統計分析服務
- [ ] **TemplateService** - 範本管理服務
- [ ] **ValidationService** - 表單驗證服務
- [ ] 實作離線填答支援
- [ ] 建立資料同步機制

## ✅ 完成標準
- [ ] 管理員可以設計各種類型的問卷
- [ ] 支援多種題型和邏輯跳轉
- [ ] 使用者可以順暢填寫問卷
- [ ] 填答進度可以儲存和恢復
- [ ] 統計分析功能完整且準確
- [ ] 報表匯出功能正常運作
- [ ] 問卷範本系統可用
- [ ] 行動裝置填答體驗良好
- [ ] 所有功能通過測試

## 📋 支援的題型

### 基本題型
1. **單選題** - 單一選項選擇
2. **多選題** - 多個選項選擇
3. **填空題** - 文字輸入
4. **長文本** - 多行文字輸入
5. **數字輸入** - 純數字輸入
6. **日期選擇** - 日期時間選擇
7. **評分題** - 星級評分或數字評分
8. **量表題** - Likert 量表

### 進階題型
9. **矩陣題** - 表格式多題組合
10. **排序題** - 拖拉排序
11. **上傳題** - 檔案上傳
12. **簽名題** - 電子簽名
13. **地址題** - 地址選擇器
14. **聯絡資訊** - 電話、Email 格式
15. **圖片選擇** - 以圖片為選項
16. **NPS 題** - 淨推薦值題型

## 🔀 邏輯跳轉功能
### 跳轉條件
- **答案條件**: 根據特定答案跳轉
- **分數條件**: 根據累計分數跳轉
- **組合條件**: 多個條件的邏輯組合
- **隨機跳轉**: 隨機分配不同路徑

### 跳轉動作
- **跳到指定題目**: 直接跳轉到某題
- **跳過題組**: 跳過一組相關題目
- **結束問卷**: 提前結束問卷填答
- **顯示訊息**: 顯示特定提示訊息

## 📊 API 端點清單

### 問卷管理 API (管理員)
1. `GET /api/admin/surveys` - 取得問卷列表
2. `POST /api/admin/surveys` - 新增問卷
3. `PUT /api/admin/surveys/{id}` - 更新問卷
4. `DELETE /api/admin/surveys/{id}` - 刪除問卷
5. `POST /api/admin/surveys/{id}/publish` - 發布問卷
6. `GET /api/admin/surveys/{id}/analytics` - 問卷統計分析
7. `GET /api/admin/surveys/templates` - 問卷範本清單
8. `POST /api/admin/surveys/templates` - 儲存範本

### 問卷填答 API (使用者)
9. `GET /api/surveys` - 取得可填問卷列表
10. `GET /api/surveys/{id}` - 取得問卷內容
11. `POST /api/surveys/{id}/response` - 提交問卷回應
12. `PUT /api/surveys/{id}/draft` - 儲存填答草稿
13. `GET /api/surveys/my-responses` - 我的問卷回應
14. `GET /api/surveys/{id}/progress` - 取得填答進度

### 統計分析 API
15. `GET /api/surveys/{id}/statistics` - 基本統計資料
16. `GET /api/surveys/{id}/export` - 匯出問卷結果
17. `GET /api/surveys/{id}/cross-analysis` - 交叉分析

## 🎨 使用者體驗設計

### 問卷設計器 UX
- **拖拉式介面**: 直觀的題目拖拉排序
- **即時預覽**: 邊設計邊預覽效果
- **範本庫**: 常用問卷範本快速套用
- **自動儲存**: 防止設計內容遺失
- **複製功能**: 快速複製現有問卷

### 填答體驗優化
- **進度指示**: 清楚顯示填答進度
- **自動對焦**: 自動對焦到下一個輸入框
- **智慧驗證**: 即時驗證並友善提示
- **草稿儲存**: 可暫停並稍後繼續
- **一頁式設計**: 避免頻繁換頁

### 行動裝置優化
- **觸控友善**: 適合手指操作的控制項
- **滑動操作**: 支援滑動換題
- **語音輸入**: 支援語音轉文字
- **離線填答**: 網路不穩時離線儲存
- **自適應布局**: 各種螢幕尺寸適配

## 📈 統計分析功能

### 基礎統計
- **回應數量**: 總回應數、完成率
- **選項分布**: 各選項選擇比例
- **平均分數**: 數值題型平均值
- **完成時間**: 平均填答時間統計

### 進階分析
- **交叉分析**: 不同群體間的差異分析
- **相關性分析**: 題目間相關性
- **趨勢分析**: 時間序列變化
- **文字分析**: 開放題文字雲和情感分析

### 視覺化圖表
- **長條圖**: 選項分佈顯示
- **圓餅圖**: 比例關係展示
- **折線圖**: 趨勢變化呈現
- **熱力圖**: 矩陣題結果展示
- **詞雲圖**: 文字回應視覺化

## 🔒 安全性和隱私

### 資料保護
- **匿名填答**: 支援完全匿名問卷
- **資料加密**: 敏感資料加密儲存
- **存取控制**: 分級權限管理
- **資料保留**: 自動清理過期資料

### 防作弊機制
- **IP 限制**: 同一 IP 填答次數限制
- **時間檢查**: 異常快速填答偵測
- **一致性檢查**: 邏輯矛盾檢測
- **重複檢查**: 重複填答阻擋

## 🧪 測試項目
- [ ] 問卷設計器功能測試
- [ ] 各種題型填答測試
- [ ] 邏輯跳轉正確性測試
- [ ] 統計分析準確性測試
- [ ] 匯出功能完整性測試
- [ ] 行動裝置相容性測試
- [ ] 效能測試 (大量回應處理)
- [ ] 安全性測試

## 🔗 相關資源
- Chart.js 圖表庫文件
- Survey.js 問卷框架參考
- D3.js 資料視覺化指南
- Excel 匯出功能實作

## 📋 後續工作項目
- WI-010: 後台管理介面完善
- WI-011: 系統整合測試

## 📝 備註
- 考慮未來與 BI 系統整合的可能性
- 預留與外部問卷平台串接的介面
- 建立完整的問卷範本庫
- 實作 AI 輔助的問卷設計建議功能
